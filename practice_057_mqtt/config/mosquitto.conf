# ── Eclipse Mosquitto Configuration ──────────────────────────────────
# Docs: https://mosquitto.org/man/mosquitto-conf-5.html

# ── Listener ─────────────────────────────────────────────────────────
# Mosquitto 2.0+ defaults to local-only mode. We need an explicit
# listener to accept connections from the Docker host.
listener 1883
protocol mqtt

# WebSocket listener (optional, for browser-based MQTT clients)
listener 9001
protocol websockets

# ── Authentication ───────────────────────────────────────────────────
# Allow anonymous connections for local development.
# In production, use password_file or an auth plugin.
allow_anonymous true

# ── Persistence ──────────────────────────────────────────────────────
# Store retained messages and subscription data to disk.
# This ensures retained messages survive broker restarts.
persistence true
persistence_location /mosquitto/data/

# ── Logging ──────────────────────────────────────────────────────────
log_dest stdout
log_type all
connection_messages true
log_timestamp true
